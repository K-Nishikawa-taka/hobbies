<%= render 'comments/error', comment: @comment %>

<%= render 'comments/new', message: @message, comment: @comment %>

<%= render 'messages/message', message: @message %>

<% if @message.user == current_user %>
  <%= link_to '削除', room_message_path(@message.room.id, @message.id), method: :delete %>
<% end %>

<% if current_user.admin? %>
  <%= link_to '削除', room_message_path(@message.room.id, @message.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
<% end %>

<% @message.comments.each do |comment| %>
  <div>
    <p><%= comment.words %></p>
    <div>
      <%= attachment_image_tag comment, :post_image, :fill, 200, 200 %>
    </div>
    <div>
      <%= comment.created_at.to_s(:datetime_jp) %>
    </div>
  </div>
  <div>
    <div>
      <%= attachment_image_tag comment.user, :icon_image, :fill, 60, 60 %>
    </div>
    <div>
      <p>
        <%= link_to user_path(comment.user.id) do %>
          <%= comment.user.name %>
        <% end %>
      </p>
      <p>
        <%= comment.user.personal_id %>
      </p>
      <div>
        <% if current_user == @message.user %>
          <% if comment.is_read == false %>
            <%= button_to "既読",room_message_comment_read_path(comment.message.room.id, comment.message.id, comment.id), method: :patch %>
          <% else %>
            <p>既読</p>
          <% end %>
        <% end %>
      </div>
      <div>
        <% if current_user == comment.user %>
          <% if comment.is_read == true %>
            <p>既読</p>
          <% end %>
        <% end %>
      </div>
    </div>

    <% if comment.user == current_user %>
      <%= link_to '削除', room_message_comment_path(comment.message.room.id, comment.message.id, comment.id), method: :delete %>
    <% end %>

    <% if current_user.admin? %>
      <%= link_to '削除', room_message_comment_path(comment.message.room.id, comment.message.id, comment.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
    <% end %>

  </div>
<% end %>
